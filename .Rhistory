statev = state_var, ret_cm = FALSE
)
baseline_output
baseline_output
baseline_output$CA
head(baseline_output$CA)
plot(seq(o, 365, 1),baseline_output$CA)
plot(seq(0, 365, 1),baseline_output$CA)
plot(seq(0, 365, 10),baseline_output$CA)
plot(seq(0, 365, 9),baseline_output$CA)
plot(seq(0, 365, 12),baseline_output$CA)
plot(seq(0, 365, 1),baseline_output$CA)
tail(baseline_output$CA)
filter(baseline_output$CA)
baseline_output %>% filter(CA)
baseline_output %>% filter(CA=120)
baseline_output %>% filter(CA == 120)
baseline_output %>% filter(CA == 120, time == 1)
baseline_output %>% filter( time == 1)
baseline_output %>% gruop_by(CA)
baseline_output %>% group_by(CA)
baseline_output %>% group_by(CA) %>% filter(time == 1)
?group_by
reticulate::repl_python()
print("Hello")
n
library(dplyr)
library(tidyr)
library(dplyr)
library(deSolve)
target <- tail(.args, 1)
load(.args[[1]])
.args <- if(interactive()){
c("./data/sars_cov_2.RData",  # inputs
"./functions/functions.RData",
"./output/sars_cov_2_outputs.RData")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
load(.args[[1]])
load(.args[[2]])
# Run the model to produce all rates of a disease at baseline
# base_sar2 <- c(ps=.75, du = 15, cc = 20)
baseline_output <- run_covid(
t = time_seq,
pp = parm_values,
vals = baseline_vals,
statev = state_var, ret_cm = FALSE
)
baseline_output
baseline_output %>% mutate(sam = rowSums())
baseline_output %>% mutate(sam = rowSums(baseline_output))
head(baseline_output %>% mutate(sam = rowSums(baseline_output)))
head(baseline_output %>% mutate(sam = rowSums(Hts, Htd)))
head(baseline_output %>% mutate(sam = rowSums(baseline_output$Hts, baseline_output$Htd)))
head(baseline_output %>% mutate(sam = rowSums(c(baseline_output$Hts, baseline_output$Htd))))
c(baseline_output$Hts, baseline_output$Htd)
rbind(baseline_output$Hts, baseline_output$Htd)
cbind(baseline_output$Hts, baseline_output$Htd)
head(baseline_output %>% mutate(sam = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))))
head(baseline_output %>% mutate(sam = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))), 10)
# Run the model to produce all rates of a disease at baseline
# base_sar2 <- c(ps=.75, du = 15, cc = 20)
baseline_output <- run_covid(
t = time_seq,
pp = parm_values,
vals = baseline_vals,
statev = state_var, ret_cm = FALSE
)
# Run the model to produce all rates of a disease at baseline
# base_sar2 <- c(ps=.75, du = 15, cc = 20)
baseline_output <- run_covid(
t = time_seq,
pp = parm_values,
vals = baseline_vals,
statev = state_var, ret_cm = FALSE
)
baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd)))
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd)))
View(baseline_output)
plot(baseline_output$time, baseline_output$Cur_addm)
plot(baseline_output$time, baseline_output$CA)
lines(baseline_output$time, baseline_output$CA)
plot(baseline_output$time, baseline_output$CA)
lines(baseline_output$time, baseline_output$Cur_addm)
plot(baseline_output$time, baseline_output$CA, type = "l")
lines(baseline_output$time, baseline_output$Cur_addm)
baseline_output$Cur_addm
head(baseline_output$Cur_addm)
.args <- if(interactive()){
c("./data/sars_cov_2_par.xlsx",   # inputs
"./data/sars_cov_2_baseline.xlsx",
"./data/sars_cov_2.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
library(readxl)
baseline_vals_raw <- read_excel(.args[2])
baseline_vals <- c(ps = as.numeric(baseline_vals_raw$ps),
du = as.numeric(baseline_vals_raw$du),
cc = as.numeric(baseline_vals_raw$cc))
baseline_vals
baseline_vals_raw
baseline_output$Cur_addm[1]
baseline_output$Cur_addm[2]
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutatae(cum_add_days = sapply(1:nrow(Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
}))
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = sapply(1:nrow(Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
}))
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = sapply(1:nrow(baseline_output$Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
}))
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd)))
baseline_output <- baseline_output %>%
mutate(cum_add_days = sapply(1:nrow(baseline_output$Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
}))
nrow(baseline_output$Cur_addm)
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd)))
nrow(baseline_output$Cur_addm)
nrow(new_vals)
length(new_vals)
sapply(1:nrow(baseline_output$Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
})
length(baseline_output$Cur_addm)
sapply(1:length(baseline_output$Cur_addm), function(ii) {
Cur_addm[ii] + Cur_addm[ii - 1]
})
sapply(1:length(baseline_output$Cur_addm), function(ii) {
baseline_output$Cur_addm[ii] + baseline_output$Cur_addm[ii - 1]
})
View(baseline_output)
sapply(1:length(baseline_output$Cur_addm), function(ii) {
baseline_output$Cur_addm[ii] + baseline_output$Cur_addm[ii - 1]
}) %>% View()
head(baseline_output$Cur_addm)
baseline_output <- baseline_output %>%
mutate(cum_add_days = sapply(1:length(baseline_output$Cur_addm), function(ii) {
baseline_output$Cur_addm[ii] + baseline_output$Cur_addm[ii - 1]
}))
baseline_output
head(baseline_output)
plot(baseline_output$time, baseline_output$cum_add_days)
plot(baseline_output$time, baseline_output$CA)
plot(baseline_output$time, baseline_output$CA, type = "l")
lines(baseline_output$time, baseline_output$cum_add_days)
lines(baseline_output$time, baseline_output$cum_add_days, col = "blue")
lines(baseline_output$time, baseline_output$Cur_addm, col = "pink")
lines(baseline_output$time, baseline_output$Cur_addm, col = "red")
baseline_output %>% select(time, Hts, Htd, Cur_addm, cum_add_days)
baseline_output %>% select(time, Hts, Htd, Cur_addm, cum_add_days) %>% View()
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm))
baseline_output
View(baseline_output)
plot(baseline_output$time, baseline_output$CA)
plot(baseline_output$time, baseline_output$CA, type = "l")
lines(baseline_output$time, baseline_output$Cur_addm, col = "red")
lines(baseline_output$time, baseline_output$cum_add_days, col = "blue")
plot(baseline_output$time)
plot(baseline_output$time, baseline_output$cum_add_days)
plot(baseline_output$time, baseline_output$CA, type = "l")
lines(baseline_output$time, baseline_output$cum_add_days, type = "p", col = "red")
plot(baseline_output$time, baseline_output$cum_add_days, type = "p", col = "red")
lines(baseline_output$time, baseline_output$CA, type = "l")
lines(baseline_output$time, baseline_output$cum_add_days, col = "blue")
lines(baseline_output$time, baseline_output$Cur_addm, col = "red")
.args <- if(interactive()){
c("./data/sars_cov_2.RData",  # inputs
"./functions/functions.RData",
"./output/sars_cov_2_outputs.RData")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
library(dplyr)
library(deSolve)
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
# Run the model to produce all rates of a disease at baseline
# base_sar2 <- c(ps=.75, du = 15, cc = 20)
baseline_output <- run_covid(
t = time_seq,
pp = parm_values,
vals = baseline_vals,
statev = state_var, ret_cm = FALSE
)
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm))
View(baseline_output)
3300/9
150000*2.3*0.1
150*2.3*0.1
150*2.3*0.5
150*2.3*0.05
150*2.3*0.3
150*2.3*0.4
150*2.3*0.5
load("~/SACEMA PROJECT/Project/Project_Msc/output/ebola_outputs.RData")
load("~/SACEMA PROJECT/Project/Project_Msc/output/sars_cov_2_outputs.RData")
load("~/SACEMA PROJECT/Project/Project_Msc/output/sars_cov_2_outputs.RData")
View(cum_mortality_df)
View(baseline_output)
load("./outputs/cum_mortality_df")
load("./outputs/sars_cov_2_outputs.RData")
load("./output/sars_cov_2_outputs.RData")
cum_mortality_df
library(dplyr)
library(ggplot2)
library(dplyr)
library(tidyr)
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
cum_mortality_df %>% filter(ps == treat_ps, du == treat_du, cc == treat_cc)
base_cc <- 35
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
cum_mortality_df %>% filter(ps == treat_ps, du == treat_du, cc == treat_cc)
cum_mortality_df %>% filter(ps == treat_ps)
cum_mortality_df %>% filter(du == treat_du)
cum_mortality_df %>% filter(cc == treat_cc)
base_cc <- 30
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
cum_mortality_df %>% filter(ps == treat_ps, du == treat_du, cc == treat_cc)
unique(cum_mortality_df$cc)
c(seq(20, 55, 5), seq(60, 300, 20))
names(cum_mortality_df)
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>% filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>% select(cm)
treat_cm
base_ps <- .7
base_du <- 15
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>% filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>% select(cm)
cum_mortality_df %>% filter(ps == base_ps, du == base_du
)
unique(cum_mortality_df$du)
unique(cum_mortality_df$ps)
cum_mortality_df %>% filter(ps == base_ps, du == base_du)
base_ps <- .7
base_du <- 15
base_cc <- 20
cum_mortality_df %>% filter(ps == base_ps, du == base_du)
cum_mortality_df %>% filter(ps == base_ps
)
base_ps <- .70
cum_mortality_df %>% filter(ps == base_ps, du == base_du)
cum_mortality_df %>% filter(ps == base_ps, du == base_du) %>% mutate(tmp = abs(cm - treat_cm))
cum_mortality_df %>% mutate(tmp = abs(cm - treat_cm))
cum_mortality_df %>% mutate(tmp = abs(cm - unname(treat_cm)))
unname(treat_cm)
cum_mortality_df %>% mutate(tmp = abs(cm - as.numeric(treat_cm)))
cum_mortality_df %>% mutate(tmp = abs(cm - as.numeric(treat_cm))) %>% group_by(ps, du) %>% filter(tmp == min(tmp))
View(cum_mortality_df %>% mutate(tmp = abs(cm - as.numeric(treat_cm))) %>% group_by(ps, du) %>% filter(tmp == min(tmp)))
unique(cum_mortality_df$cc)
base_ps <- .70
base_du <- 15
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
cum_mortality_df %>%
filter(ps == base_ps, du == base_du) %>%
mutate(abs(cm - treat_cm))
cum_mortality_df
treat_cm
load("./output/sars_cov_2_outputs.RData")
base_ps <- .70
base_du <- 15
base_cc <- 20
# Remdesiver treatment
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
library(tidyr)
library(dplyr)
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
cum_mortality_df %>%
filter(ps == base_ps, du == base_du) %>%
mutate(abs(cm - treat_cm))
cum_mortality_df %>%
filter(du == base_du) %>%
mutate(abs(cm - treat_cm))
cum_mortality_df %>%
filter(ps == base_ps)
cum_mortality_df %>%
filter(ps == .8\)
cum_mortality_df %>%
filter(ps == .8)
cum_mortality_df %>%
filter(ps == .78)
cum_mortality_df %>%
filter(ps == .9)
cum_mortality_df %>%
filter(ps == .71)
cum_mortality_df %>%
filter(ps == .69)
cum_mortality_df %>%
filter(ps == .6)
cum_mortality_df %>%
filter(ps == .68)
cum_mortality_df %>%
filter(ps == .68)
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2))
round(base_ps, 2)
base_ps
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(abs(cm - treat_cm))
base_ps <- .75
base_du <- 12
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(abs(cm - treat_cm))
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = abs(cm - as.numeric(treat_cm)))
base_ps <- .7
base_du <- 15
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = abs(cm - as.numeric(treat_cm)))
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = cm - as.numeric(treat_cm))
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>% filter(abs(tmp) < 5)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>% filter(abs(tmp) == min(abs(tmp)))
bed_scen
load("~/SACEMA PROJECT/Project/Project_Msc/data/sars_cov_2.RData")
View(new_vals)
cum_mortality_df
View(cum_mortality_df)
View(baseline_output)
View(cum_mortality_df)
load("./output/sars_cov_2_outputs.RData")
base_ps <- .70
base_du <- 15
base_cc <- 20
treat_ps <- .93
treat_du <- 15
treat_cc <- base_cc
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
libriary(tydyverse)
libriary(tidyverse)
libriary(tidyvers)
library(tidyverse)
treat_cm <- cum_mortality_df %>%
filter(ps == treat_ps, du == treat_du, cc == treat_cc) %>%
select(cm)
View(treat_cm)
View(cum_mortality_df)
cum_mortality_df %>%
filter(ps == base_ps, du == base_du) %>%
mutate(abs(cm - treat_cm))
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = abs(cm - treat_cm))
cum_mortality_df %>%
filter(round(ps, 2) == round(base_ps, 2), du == base_du) %>%
mutate(tmp = abs(cm - as.numeric(treat_cm)))
treat_cm
View(cum_mortality_df %>%
mutate(tmp = abs(cm - as.numeric(treat_cm))) %>%
group_by(ps, du) %>% filter(tmp == min(tmp)))
library(tidyverse)
p <- new_vals %>% filter(round(ps, 2) == round(.69, 2), du == 19, cc == 20)
library(tidyverse)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",  # inputs
"./functions/functions.RData",
"./output/sars_cov_2_outputs.RData")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
library(deSolve)
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
p <- new_vals %>% filter(round(ps, 2) == round(.69, 2), du == 19, cc == 20)
run_covid(
t = time_seq,
pp = parm_values,
vals = p,
statev = state_var,
ret_cm = FALSE
)
p
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.69, 2), du == 19, cc == 20)
run_covid(
t = time_seq,
pp = parm_values,
vals = rem_beds_tret,
statev = state_var,
ret_cm = FALSE
)
styler:::style_selection()
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.69, 2), du == 19, cc == 20)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = rem_beds_tret,
statev = state_var,
ret_cm = FALSE
)
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.69, 2), du == 19, cc == 20)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = rem_beds_tret,
statev = state_var,
ret_cm = FALSE
)
my_df <- my_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm))
my_df
tail(my_df, 2)
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm))
# Run the model to produce all rates of a disease at baseline
# base_sar2 <- c(ps=.75, du = 15, cc = 20)
baseline_output <- run_covid(
t = time_seq,
pp = parm_values,
vals = baseline_vals,
statev = state_var, ret_cm = FALSE
)
baseline_output <- baseline_output %>%
mutate(Cur_addm = rowSums(cbind(baseline_output$Hts, baseline_output$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm))
tail(my_df, 2)
tail(baseline_output)
tail(baseline_output,2)
tail(my_df, 2)
my_df$Cur_addm
nrow(my_df$Cur_addm)
tail(my_df$Cur_addm, 1)
tail(baseline_output$Cur_addm, 1)
.args <- if(interactive()){
c("./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
base_rem <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 28)
treat_rem <- cum_mortality_df %>%
filter(ps == .93, du == 15, cc == 20)
treat_cm <- treat_rem %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.70, 2), du == 15) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
saveRDS(bed_scen, file = target)
bed_scen
