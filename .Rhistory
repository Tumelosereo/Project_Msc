cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
library(deSolve)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(treat_df$Hts, treat_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(casual_df$Hts, casual_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(treat_df, 1)[,2]
tail(casual_df, 1)[1]
p <- c("watch one episode", "do dishes", "sleep", "work for an hour")
p
p <- c("watch one episode", "do dishes", "sleep", "work for an hour")
p
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
p
sample(p, 1)
p
sample(p, 1)
p
p
sample(p, 1)
sample(p, 1)
p
p
sample(p, 1)
library(tidyverse)
bed_scen <- readRDS("./data/cost_analysis.rds")
load("output/sars_cov_2_outputs.RData")
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
target <- tail(.args, 1)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.rds",
"./data/toci_treat.xlsx",
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
library(readxl)
load(.args[[1]])
load(.args[[2]])
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
saveRDS(bed_scen, file = target)
library(tidyverse)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.rds",
"./data/toci_treat.xlsx",
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
library(readxl)
load(.args[[1]])
load(.args[[2]])
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
save(bed_scen, file = target)
load(.args[[1]])
load(.args[[2]])
treat <- read_excel(.args[3])
library(tidyverse)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.rds",
"./data/toci_treat.xlsx",
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
library(readxl)
load(.args[[1]])
load(.args[[2]])
treat <- read_excel(.args[3])
usual_care <- treat$usual_value
names(usual_care) <- treat$parms
treat_care <- treat$treat_value
names(treat_care) <- treat$parms
cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(treat_df$Hts, treat_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
library(deSolve)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
load(.args[[1]])
load(.args[[2]])
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(treat_df$Hts, treat_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(casual_df$Hts, casual_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
save(treat_df, casual_df, file = target)
my_data <- readRDS("~/SACEMA PROJECT/Project/Project_Msc/output/my_data.rds")
View(bed_scen)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.rds",
"./data/toci_treat.xlsx",
"./output/my_data.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
library(readxl)
load(.args[[1]])
load(.args[[2]])
treat <- read_excel(.args[3])
usual_care <- treat$usual_value
names(usual_care) <- treat$parms
treat_care <- treat$treat_value
names(treat_care) <- treat$parms
cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(treat_df$Hts, treat_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(casual_df$Hts, casual_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
save(treat_df, casual_df, file = target)
load("~/SACEMA PROJECT/Project/Project_Msc/output/my_data.RData")
bed_scen <- readRDS("./data/cost_analysis.rds")
cost_analysis <- readRDS("~/SACEMA PROJECT/Project/Project_Msc/data/cost_analysis.rds")
cost_analysis <- readRDS("~/SACEMA PROJECT/Project/Project_Msc/data/cost_analysis.rds")
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.RData")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
library(tidyverse)
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
save(bed_scen, file = target)
load("~/SACEMA PROJECT/Project/Project_Msc/data/cost_analysis.RData")
load("~/SACEMA PROJECT/Project/Project_Msc/output/my_data.RData")
bed_scen <- load("./data/cost_analysis.RData")
load("output/sars_cov_2_outputs.RData")
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
bed_scen
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.RData")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
save(bed_scen, file = target)
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
x_value <- seq(0, 10, 0.1)
cost_ba <- function(x, inputs) {
with(as.list(inputs), {
(A_b - A_t + delta.B * x) / H
})
}
cost_value <-  cost_ba(x = x_value,
inputs = inputs)
cost_df <- data.frame(cost_value,
x_value)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ lims(y = c(0, 5))
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ yim(y = c(0, 5))
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ ylim(y = c(0, 5))
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ ylim = c(0, 5)
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ ylim = c(0, 5)
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
+ lims(y = c(0, 5))
)
(ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = "Cb/Ca",
y = "Ct/Ca")
)
library(tidyverse)
.args <- if(interactive()){
c("./data/cost_analysis.RData", # Outputs
"./figs/toci_cost.jpg")
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
.args <- if(interactive()){
c("./data/cost_analysis.RData", # Outputs
"./figs/toci_cost.jpg")
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
load(.args[[1]])
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
.args <- if(interactive()){
c("./data/cost_analysis.RData", # Outputs
"output/sars_cov_2_outputs.RData",
"./figs/toci_cost.jpg")
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
load("~/SACEMA PROJECT/Project/Project_Msc/output/my_data.RData")
.args <- if(interactive()){
c("./data/cost_analysis.RData", # Outputs
"/output/my_data.RData",
"./figs/toci_cost.jpg")
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
.args <- if(interactive()){
c("./data/cost_analysis.RData", # Outputs
"./output/my_data.RData",
"./figs/toci_cost.jpg")
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
x_value <- seq(0, 20, 0.1)
cost_ba <- function(x, inputs) {
with(as.list(inputs), {
(A_b - A_t + delta.B * x) / H
})
}
cost_value <-  cost_ba(x = x_value,
inputs = inputs)
cost_df <- data.frame(cost_value,
x_value)
plot3 <- (ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = bquote(C[B]/C[A]),
y = bquote(C[T]/C[A]))
+ theme_bw()
+ ylim(c(5, 7))
)
library(ggplot2)
plot3 <- (ggplot(cost_df)
+ geom_line(aes(x = x_value,
y = cost_value))
+ labs(x = bquote(C[B]/C[A]),
y = bquote(C[T]/C[A]))
+ theme_bw()
+ ylim(c(5, 7))
)
library(tidyverse)
c(
"./output/my_data.RData",
"./figs/toci_cost.jpg") # Outputs
.args <- if(interactive()){
c(
"./output/my_data.RData",
"./figs/toci_cost.jpg") # Outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
inputs <- c(H = tail(treat_df$CA, 1),
A_t = tail(treat_df$cum_add_days, 1),
A_b = tail(casual_df$cum_add_days, 1),
delta.B = bed_scen$cc - 20)
.args <- if(interactive()){
c("./data/cost_analysis.RData",
"./output/my_data.RData",
"./figs/toci_cost.jpg") # Outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
library(tidyverse)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.RData",
"./data/toci_treat.xlsx",
"./output/my_data.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/cost_analysis.RData",
"./data/toci_treat.xlsx",
"./output/my_data.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
library(readxl)
load(.args[[1]])
load(.args[[2]])
treat <- read_excel(.args[3])
treat
