filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
bed_scen
.args <- if(interactive()){
c("./data/sars_cov_2_par.xlsx",   # inputs
"./data/sars_cov_2_baseline.xlsx",
"./data/sars_cov_2.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.65, 2), du == 28, cc == 28)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
library(readxl)
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.65, 2), du == 28, cc == 28)
list = ls()
load(.args[[1]])
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.65, 2), du == 28, cc == 28)
rem_beds_tret <- new_vals %>% filter(round(ps, 2) == round(.65, 2), du == 28, cc == 26)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = rem_beds_tret,
statev = state_var,
ret_cm = FALSE
)
library(deSolve)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = rem_beds_tret,
statev = state_var,
ret_cm = FALSE
)
my_df <- my_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
library(readxl)
read_excel("data/toci_treat")
read_excel("./data/toci_treat")
read_excel("./data/toci_treat.xlsx")
read_excel("./data/toci_treat.xlsx")
pp <- read_excel(.args[1])
.args <- if(interactive()){
c("./data/sars_cov_2_par.xlsx",   # inputs
"./data/sars_cov_2_baseline.xlsx",
"./data/sars_cov_2.RData") # output
}else{
commandArgs(trailingOnly = TRUE)
}
pp <- read_excel(.args[1])
pp
toci_treat <- read_excel("./data/toci_treat.xlsx")
toci_treat$usal_value
parm_values <- pp$Value
parm_values
names(parm_values) <- pp$Code
parm_values
?names
toci_treat
toci_treat$usal_value
names(toci_treat$usal_value)
usal_care <- toci_treat$usal_value
usal_care
names(usal_care) <- toci_treat$parms
usal_care
treat_care <- toci_treat$treat_value
treat_care <- toci_treat$treat_value
names(treat_care) <- toci_treat$parms
treat_care
usal_care
new_vals %>% filter(round(ps, 2) == round(.65, 2), du == 28, cc == 26)
c(treat_care, cc == 26)
c(treat_care, cc == 26)
treat_care
typeof(treat_care)
c(treat_care, cc = 26)
c(treat_care, bed_scen$cc)
rem_beds_tret
usual_care <- toci_treat$usal_value
names(usal_care) <- toci_treat$parms
treat_care <- toci_treat$treat_value
names(treat_care) <- toci_treat$parms
c(usual_care, bed_scen$cc)
rem_beds_tret
c(usual_care, bed_scen$cc)
usual_care
usual_care <- toci_treat$usal_value
names(usal_care) <- toci_treat$parms
usual_care
toci_treat <- read_excel("./data/toci_treat.xlsx")
usual_care <- toci_treat$usual_value
names(usal_care) <- toci_treat$parms
usual_care <- toci_treat$usual_value
names(usal_care) <- toci_treat$parms
usual_care
usual_care <- toci_treat$usual_value
names(usual_care) <- toci_treat$parms
toci_treat <- read_excel("./data/toci_treat.xlsx")
usual_care <- toci_treat$usual_value
names(usual_care) <- toci_treat$parms
usual_care
c(usual_care, bed_scen$cc)
c(usual_care, cc = bed_scen$cc)
rem_beds_tret
cout_usual <- c(usual_care, cc = bed_scen$cc)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE
)
my_df <- my_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
toci_treat <- read_excel(.args[[2]])
treat <- read_excel(.args[[2]])
usual_care <- toci$usual_value
treat <- read_excel(.args[[2]])
usual_care <- treat$usual_value
names(usual_care) <- treat$parms
treat_care <- treat$treat_value
names(treat_care) <- treat$parms
treat
treat <- read_excel(.args[[2]])
treat <- read_excel(.args[2])
usual_care <- treat$usual_value
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/toci_treat.xlsx",
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
library(readxl)
treat <- read_excel(.args[2])
treat
usual_care <- treat$usual_value
names(usual_care) <- treat$parms
treat_care <- treat$treat_value
names(treat_care) <- treat$parms
load(.args[[1]])
cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_care
usual_care
cout_usual <- c(usual_care, cc = bed_scen$cc)
cout_usual
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
cum_mortality_df
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
bed_scen
toci_df <- data.frame(treat_care, usual_care)
toci_df
cout_usual <- c(usual_care, cc = bed_scen$cc)
toci_df <- data.frame(treat_care, usual_care, cc = 20)
toci_df
toci_df <- data.frame(c(treat_care, usual_care), cc = 20)
toci_df
sapply(1:nrow(toci), function (i)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[i, ],cc = 20),
statev = state_var,
ret_cm = FALSE
)
)
sapply(1:nrow(toci_df), function (i)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[i, ],cc = 20),
statev = state_var,
ret_cm = FALSE
)
)
toci_df
toci_df <- data.frame(treat_care, usual_care)
toci_df
sapply(1:nrow(toci_df), function (i)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[i, ],cc = 20),
statev = state_var,
ret_cm = FALSE
)
)
toci_df
toci_df[1,]
toci_df[2,]
toci_df <- cbind(treat_care, usual_care)
toci_df
toci_df <- rbind(treat_care, usual_care)
toci_df
treat_care
treat_care
toci_df
toci_df[1,]
c(toci_df[i, ],cc = 20)
c(toci_df[1, ],cc = 20)
sapply(1:nrow(toci_df), function (i)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[i, ],cc = 20),
statev = state_var,
ret_cm = FALSE
)
)
look <- sapply(1:nrow(toci_df), function (i)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[i, ],cc = 20),
statev = state_var,
ret_cm = FALSE
)
)
look %>% View()
unlist(look)
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(toci_df[1, ],cc = 20),
statev = state_var,
ret_cm = FALSE )
my_df
my_df <- my_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
bed_scen$cc
treat_care
my_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
my_df
my_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
tail(my_df, 1)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(my_df, 1)
cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_care
c(treat_care,cc = 20)
treat_df
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
tail(treat_df, 1)
cout_usual
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(casual_df, 1)
tail(treat_df, 1)
treat_bed <- cbind(t = tail(treat_df, 1),
u = tail(casual_df, 1))
treat_bed
treat_bed <- rbind(t = tail(treat_df, 1),
u = tail(casual_df, 1))
treat_bed
treat_bed[1,]
treat_bed$CA
tail(treat_df, 1)
t = tail(treat_df, 1)
t
treat_bed <- rbind(t = tail(treat_df, 1),
u = tail(casual_df, 1))
treat_bed[1,]
treat_bed[1,]$CA
treat_bed[1,]$cum_add_days
treat_bed[1,]$CA
tail(treat_df, 1)
tail(casual_df, 1)
tail(treat_df, 1)$CA
tail(treat_df, 1)$CA
tail(treat_df, 1)
treat_df
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
tail(treat_df, 1)
tail(treat_df, 1)$CA
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(casual_df, 1)
tail(treat_df, 1)
cout_usual <- c(usual_care, cc = 28)
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(casual_df, 1)
tail(treat_df, 1)[1]
tail(treat_df, 1)[2]
tail(treat_df, 1)[2]
tail(treat_df, 1)[,2]
tail(treat_df, 1)[1,1]
tail(treat_df, 1)[,2]
tail(casual_df, 1)
tail(casual_df, 1)[1]
inputs <- c(H = tail(treat_df, 1)[1],
A_t = tail(treat_df, 1)[,2],
A_b = tail(casual_df, 1)[1],
delta.B = bed_scen$cc - 20)
inputs
tail(treat_df, 1)[,2]
tail(casual_df, 1)[1]
library(tidyverse)
.args <- if(interactive()){
c("./data/sars_cov_2.RData",   # inputs
"./data/toci_treat.xlsx",
"./output/my_data.rds") # output
}else{
commandArgs(trailingOnly = TRUE)
}
library(readxl)
load(.args[[1]])
treat <- read_excel(.args[2])
usual_care <- treat$usual_value
names(usual_care) <- treat$parms
treat_care <- treat$treat_value
names(treat_care) <- treat$parms
cout_usual <- c(usual_care, cc = bed_scen$cc)
.args <- if(interactive()){
c("./functions/functions.RData",
"./output/sars_cov_2_outputs.RData",  # inputs
"./data/cost_analysis.rds")  # outputs
}else{
commandArgs(trailingOnly = TRUE)
}
target <- tail(.args, 1)
load(.args[[1]])
load(.args[[2]])
base_toc <- cum_mortality_df %>%
filter(ps == .65, du == 28, cc == 20)
treat_toc <- cum_mortality_df %>%
filter(round(ps, 2) == round(.69, 2), du == 15, cc == 20)
treat_cm <- treat_toc %>% select(cm)
bed_scen <- cum_mortality_df %>%
filter(round(ps, 2) == round(.65, 2), du == 28) %>%
mutate(tmp = cm - as.numeric(treat_cm)) %>%
filter(abs(tmp) == min(abs(tmp)))
saveRDS(bed_scen, file = target)
cout_usual <- c(usual_care, cc = bed_scen$cc)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
library(deSolve)
treat_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = c(treat_care,cc = 20),
statev = state_var,
ret_cm = FALSE )
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(my_df$Hts, my_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
treat_df
treat_df <- treat_df %>%
mutate(Cur_addm = rowSums(cbind(treat_df$Hts, treat_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
casual_df <- run_covid(
t = time_seq,
pp = parm_values,
vals = cout_usual,
statev = state_var,
ret_cm = FALSE )
casual_df <- casual_df %>%
mutate(Cur_addm = rowSums(cbind(casual_df$Hts, casual_df$Htd))) %>%
mutate(cum_add_days = cumsum(Cur_addm)) %>%
select(CA, cum_add_days)
tail(treat_df, 1)[,2]
tail(casual_df, 1)[1]
p <- c("watch one episode", "do dishes", "sleep", "work for an hour")
p
p <- c("watch one episode", "do dishes", "sleep", "work for an hour")
p
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
sample(p, 1)
p
sample(p, 1)
p
sample(p, 1)
p
p
sample(p, 1)
sample(p, 1)
p
p
sample(p, 1)
